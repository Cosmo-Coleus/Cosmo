[bump]
features_always_bump_minor = true
breaking_always_bump_major = true
initial_tag = "0.1.0"

[changelog]
header = """
# Changelog\n
"""
body = """
{%- macro remote_url() -%}
  https://github.com/{{ remote.github.owner }}/{{ remote.github.repo }}
{%- endmacro -%}

{%- macro print_commit(commit) -%}
    - {{ commit.message | trim_end_matches(pat="\n") | upper_first }} ([{{ commit.id | truncate(length=7, end="") }}]({{ self::remote_url() }}/commit/{{ commit.id }}))
{%- endmacro -%}

{% if version %}\
    {% if previous.version %}\
        ## [{{ version | trim_start_matches(pat="v") }}]\
          ({{ self::remote_url() }}/compare/{{ previous.version }}..{{ version }}) - {{ timestamp | date(format="%Y-%m-%d") }}
    {% else %}\
        ## [{{ version | trim_start_matches(pat="v") }}] - {{ timestamp | date(format="%Y-%m-%d") }}
    {% endif %}\
{% else %}\
    ## [unreleased]
{% endif %}\

{% for group, commits in commits | group_by(attribute="group") %}
    ### {{ group | striptags | trim | upper_first }}
    {% for commit in commits
    | filter(attribute="scope")
    | sort(attribute="scope") %}
        {{ self::print_commit(commit=commit) }}
    {%- endfor -%}
    {% raw %}\n {% endraw %}\
    {%- for commit in commits %}
        {%- if not commit.scope -%}
            {{ self::print_commit(commit=commit) }}
        {% endif -%}
    {% endfor -%}
{% endfor %}\n
"""
trim = true

postprocessors = [
    { pattern = 'Breaking:', replace = 'ğŸ’¥' },
    { pattern = 'Feat:', replace = 'âœ¨' },
    { pattern = 'Hotfix:', replace = 'ğŸš‘' },
    { pattern = 'Deprecate:', replace = 'ğŸ—‘ï¸' },
    { pattern = 'Add-dependency:', replace = 'â•' },
    { pattern = 'Upgrade-dependency:', replace = 'â¬†ï¸' },
    { pattern = 'Fix:', replace = 'ğŸ›' },
    { pattern = 'Simple-fix:', replace = 'ğŸ©¹' },
    { pattern = 'Performance:', replace = 'âš¡' },
    { pattern = 'Security:', replace = 'ğŸ”’' }
]

[git]
conventional_commits = false
filter_unconventional = false
split_commits = false
commit_preprocessors = [
    { pattern = '^ğŸ’¥', replace = 'breaking:' },
    { pattern = '^âœ¨', replace = 'feat:' },
    { pattern = '^ğŸš‘', replace = 'hotfix:' },
    { pattern = '^ğŸ—‘ï¸', replace = 'deprecate:' },
    { pattern = '^â•', replace = 'add-dependency:' },
    { pattern = '^â¬†ï¸', replace = 'upgrade-dependency:' },
    { pattern = '^ğŸ›', replace = 'fix:' },
    { pattern = '^ğŸ©¹', replace = 'simple-fix:' },
    { pattern = '^âš¡', replace = 'performance:' },
    { pattern = '^ğŸ”’', replace = 'security:' }
]

commit_parsers = [
    { message = "^breaking:", group = "<!-- 0 -->ğŸ’¥ Breaking Changes" },
    { message = "^feat:", group = "<!-- 1 -->âœ¨ Features" },
    { message = "^hotfix:", group = "<!-- 2 -->ğŸš‘ Hotfix" },
    { message = "^deprecate:", group = "<!-- 3 -->ğŸ—‘ï¸ Deprecate Code or Dependencies" },
    { message = "^add-dependency:", group = "<!-- 4 -->â• Add Dependencies" },
    { message = "^upgrade-dependency:", group = "<!-- 5 -->â¬†ï¸ Upgrade Dependencies" },
    { message = "^fix:", group = "<!-- 6 -->ğŸ› Bug Fixes" },
    { message = "^simple-fix:", group = "<!-- 7 -->ğŸ©¹ Simple Fixes" },
    { message = "^performance:", group = "<!-- 8 -->âš¡ Performance" },
    { body = "^security:", group = "<!-- 9 -->ğŸ”’ Security" }
]
protect_breaking_commits = false
filter_commits = false
tag_pattern = "v*.*"
topo_order = false
sort_commits = "oldest"

